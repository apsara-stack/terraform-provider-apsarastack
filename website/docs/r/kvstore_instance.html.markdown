---
subcategory: "Redis And Memcache (KVStore)"
layout: "apsarastack"
page_title: "Apsarastack: apsarastack_kvstore_instance"
sidebar_current: "docs-apsarastack-resource-kvstore-instance"
description: |-
  Provides an ApsaraDB Redis / Memcache instance resource.
---

# apsarastack\_kvstore\_instance

Provides an ApsaraDB Redis / Memcache instance resource. A DB instance is an isolated database environment in the cloud. It can be associated with IP whitelists and backup configuration which are separate resource providers.

## Example Usage

Basic Usage

```
variable "creation" {
  default = "KVStore"
}
variable "name" {
  default = "kvstoreinstancevpc"
}
data "apsarastack_zones" "default" {
  available_resource_creation = "${var.creation}"
}
resource "apsarastack_vpc" "default" {
  name       = "${var.name}"
  cidr_block = "172.16.0.0/16"
}
resource "apsarastack_vswitch" "default" {
  vpc_id            = "${apsarastack_vpc.default.id}"
  cidr_block        = "172.16.0.0/24"
  availability_zone = "${data.apsarastack_zones.default.zones.0.id}"
  name              = "${var.name}"
}
resource "apsarastack_kvstore_instance" "default" {
  instance_class = "redis.master.small.default"
  instance_name  = "${var.name}"
  vswitch_id     = "${apsarastack_vswitch.default.id}"
  private_ip     = "172.16.0.10"
  security_ips   = ["10.0.0.1"]
  instance_type  = "Redis"
}
```

## Argument Reference

The following arguments are supported:

* `instance_name` - (Optional) The name of DB instance. It a string of 2 to 256 characters.
* `password`- (Optional, Sensitive) The password of the DB instance. The password is a string of 8 to 30 characters and must contain uppercase letters, lowercase letters, and numbers.
* `kms_encrypted_password` - (Optional) An KMS encrypts password used to a instance. If the `password` is filled in, this field will be ignored.
* `kms_encryption_context` - (Optional, MapString) An KMS encryption context used to decrypt `kms_encrypted_password` before creating or updating instance with `kms_encrypted_password`. See [Encryption Context](https://www.alibabacloud.com/help/doc-detail/42975.htm). It is valid when `kms_encrypted_password` is set.
* `instance_class` - (Required) Type of the applied ApsaraDB for Redis instance. It can be retrieved by data source [`apsarastack_kvstore_instance_classes`](https://www.terraform.io/docs/providers/apsarastack/d/kvstore_instance_classes.html)
* `availability_zone` - (Optional, ForceNew) The Zone to launch the DB instance.
* `instance_charge_type` - (Optional) Valid values are `PrePaid`, `PostPaid`, Default to `PostPaid`.
* `period` - (Optional) The duration that you will buy DB instance (in month). It is valid when instance_charge_type is `PrePaid`. Valid values: [1~9], 12, 24, 36. Default to 1.
* `instance_type` - (Optional, ForceNew) The engine to use: `Redis` or `Memcache`. Defaults to `Redis`.
* `vswitch_id` - (Optional, ForceNew) The ID of VSwitch.
* `security_ips`- (Optional) Set the instance's IP whitelist of the default security group.
* `security_group_id` - (Optional) The Security Group ID of ECS.
* `private_ip`- (Optional) Set the instance's private IP.
* `backup_id`- (Optional) If an instance created based on a backup set generated by another instance is valid, this parameter indicates the ID of the generated backup set.
* `vpc_auth_mode`- (Optional) Only meaningful if instance_type is `Redis` and network type is VPC. Valid values are `Close`, `Open`. Defaults to `Open`.  `Close` means the redis instance can be accessed without authentication. `Open` means authentication is required.
* `parameters` - (Optional) Set of parameters needs to be set after instance was launched. Available parameters can refer to the latest docs [Instance configurations table](https://www.alibabacloud.com/help/doc-detail/61209.htm) .
* `tags` - (Optional) A mapping of tags to assign to the resource.
* `maintain_start_time` - (Optional) The start time of the operation and maintenance time period of the instance, in the format of HH:mmZ (UTC time).
* `maintain_end_time` - (Optional) The end time of the operation and maintenance time period of the instance, in the format of HH:mmZ (UTC time).

-> **NOTE:** The start time to the end time must be 1 hour. For example, the MaintainStartTime is 01:00Z, then the MaintainEndTime must be 02:00Z.

## Attributes Reference

The following attributes are exported:

* `id` - The KVStore instance ID.
* `connection_domain` - Instance connection domain (only Intranet access supported).

### Timeouts


The `timeouts` block allows you to specify [timeouts](https://www.terraform.io/docs/configuration-0-11/resources.html#timeouts) for certain actions:

* `create` - (Defaults to 20 mins) Used when creating the KVStore instance (until it reaches the initial `Normal` status). 
* `update` - (Defaults to 30 mins) Used when updating the KVStore instance (until it reaches the initial `Normal` status). 
* `delete` - (Defaults to 20 mins) Used when terminating the KVStore instance. 

## Import

KVStore instance can be imported using the id, e.g.

```
$ terraform import apsarastack_kvstore_instance.example r-abc12345678
```
